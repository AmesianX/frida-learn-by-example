import frida,sys
 
def print_result(message):
            print "[*] Decrypting AES %s" %(message)
 
def on_message(message, data):
            # print_result(message['payload'])
            # print "%s" %(message)
            print("[*] {0}".format(message))

# Has errors, not sure why.

jscode = """
Java.perform(function () {

    var c = Java.use("kr.repo.h2spice.yekehtmai.c")
    c.a.implementation = function (str1, str2) {
        
        send("String1: " + str1)
        send("String2: " + str2)
        this.onResume();

    }
    
});

"""
 
process = frida.get_usb_device(1).attach("kr.repo.h2spice.yekehtmai")
 
script = process.create_script(jscode)
script.on('message', on_message)
 
print "[*] Decrypting AES Key"
 
script.load()
sys.stdin.read()

